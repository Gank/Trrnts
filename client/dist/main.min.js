/*! Trrnts 14-07-2014 */
angular.module("trrntsApp",["trrntsApp.controllers","trrntsApp.services","trrntsApp.directives"]).config(["$compileProvider",function($compileProvider){$compileProvider.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|magnet):/)}]),angular.module("trrntsApp.controllers",[]).controller("SubmitMagnetLinkController",function($scope,MagnetLinksFactory){$scope.magnetURI="",$scope.submit=function(){$scope.magnetURI&&MagnetLinksFactory.submit($scope.magnetURI).catch(function(err){console.error(err)})}}).controller("LatestMagnetLinksController",function($scope,MagnetLinksFactory){$scope.latestMagnets=[],MagnetLinksFactory.getLatest().then(function(result){$scope.latestMagnets=result.data}).catch(function(){$scope.latestMagnets=["There has been an error houston"]})}).controller("TopMagnetLinksController",function($scope){$scope.topMagnets=[]}),angular.module("trrntsApp.directives",[]).directive("barChart",function(){return{restrict:"A",link:function(scope,element,attrs){element=element[0];var barWidth=attrs.barWidth||20,barSpace=attrs.barSpace||2,chartHeight=element.offsetHeight,data=scope.data||[12,23,23,234,324,243,3,23],y=d3.scale.linear().domain([0,d3.max(data)]).range([0,chartHeight]);d3.select(element).selectAll("rect").data(data).enter().append("rect").attr("class","bar").attr("width",barWidth).attr("x",function(d,i){return barWidth*i+barSpace*i}).attr("y",chartHeight).attr("height",0).transition().delay(function(d,i){return 100*i}).attr("y",function(d){return chartHeight-y(d)}).attr("height",function(d){return y(d)})}}}),angular.module("trrntsApp.services",[]).factory("MagnetLinksFactory",function($http){var submit=function(magnetURI){return $http({method:"POST",url:"/api/magnets",data:{magnetURI:magnetURI}})},getLatest=function(start,stop){return $http({method:"GET",url:"api/magnets/latest",params:{start:start||1,stop:stop||30}})};return{submit:submit,getLatest:getLatest}});